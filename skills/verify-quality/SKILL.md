---
name: verify-quality
description: 代码质量检查。检测复杂度、重复代码、命名规范、函数长度等质量指标。当用户提到代码质量、复杂度检查、代码异味、重构建议、lint检查、代码规范时使用。在复杂模块、重构完成时自动触发。
user-invocable: true
disable-model-invocation: false
allowed-tools: Bash, Read, Glob
argument-hint: <扫描路径>
---

# 代码质量检查

## 核心原则

```
好代码 = 可读 + 可维护 + 可测试
复杂度是 bug 的温床
```

## 自动检查

运行质量检查脚本（跨平台）：

```bash
# 在 skill 目录下运行
python scripts/quality_checker.py <扫描路径>
python scripts/quality_checker.py <扫描路径> -v      # 详细模式
python scripts/quality_checker.py <扫描路径> --json  # JSON 输出
```

## 检测指标

### 复杂度指标

| 指标 | 阈值 | 说明 |
|------|------|------|
| **圈复杂度** | ≤ 10 | 函数分支复杂度 |
| **函数长度** | ≤ 50 行 | 单个函数代码行数 |
| **文件长度** | ≤ 500 行 | 单个文件代码行数 |
| **参数数量** | ≤ 5 | 函数参数个数 |
| **行长度** | ≤ 120 | 单行字符数 |

### 命名规范

| 类型 | 规范 | 示例 |
|------|------|------|
| **类名** | PascalCase | `UserService`, `HttpClient` |
| **函数名** | snake_case | `get_user`, `process_data` |
| **常量** | UPPER_SNAKE | `MAX_RETRY`, `DEFAULT_TIMEOUT` |
| **变量** | snake_case | `user_id`, `total_count` |

### 代码异味

- ⚠️ 函数过长（> 50 行）
- ⚠️ 圈复杂度过高（> 10）
- ⚠️ 参数过多（> 5 个）
- ⚠️ 文件过长（> 500 行）
- ℹ️ 命名不规范
- ℹ️ 行过长（> 120 字符）

## 质量标准

### 优秀代码特征

```
✓ 函数短小精悍，职责单一
✓ 命名清晰，自解释
✓ 结构扁平，嵌套少
✓ 无重复代码
✓ 易于测试
```

### 需要重构的信号

```
✗ 函数超过 50 行
✗ 嵌套超过 3 层
✗ 参数超过 5 个
✗ 圈复杂度超过 10
✗ 大量注释解释代码逻辑
```

## 校验流程

```
1. 运行 quality_checker.py 自动扫描
2. 分析复杂度指标
3. 检查命名规范
4. 识别代码异味
5. 输出质量报告
```

## 重构建议

### 函数过长
```
拆分为多个小函数，每个函数只做一件事
提取重复逻辑为独立函数
```

### 复杂度过高
```
减少嵌套层级
使用早返回（guard clause）
提取条件判断为独立函数
```

### 参数过多
```
使用配置对象封装参数
使用 Builder 模式
考虑函数职责是否过重
```

---

**好的命名胜过注释，清晰的结构胜过解释。**
