---
name: security-arch
description: 安全架构设计。零信任、身份认证、威胁建模。当用户提到安全架构、零信任、IAM、身份认证、威胁建模时使用。
---

# 🏗 阵法秘典 · 安全架构设计

> 阵法推演，万象归位。此典录安全架构一脉之精要。

## 零信任架构

```
┌─────────────────────────────────────────────────────────────┐
│                    零信任原则                                │
├─────────────────────────────────────────────────────────────┤
│  1. 永不信任，始终验证                                       │
│  2. 最小权限访问                                             │
│  3. 假设已被入侵                                             │
│  4. 显式验证每个请求                                         │
│  5. 持续监控和验证                                           │
└─────────────────────────────────────────────────────────────┘
```

### 核心组件
```yaml
身份验证:
  - 多因素认证 (MFA)
  - 单点登录 (SSO)
  - 证书认证

设备信任:
  - 设备健康检查
  - 端点检测响应 (EDR)
  - 移动设备管理 (MDM)

网络分段:
  - 微分段
  - 软件定义边界 (SDP)
  - 网络访问控制

数据保护:
  - 加密传输/存储
  - 数据分类
  - DLP
```

## 身份与访问管理 (IAM)

### 认证方式
```yaml
密码认证:
  - 强密码策略
  - 密码哈希 (bcrypt/argon2)
  - 防暴力破解

多因素认证:
  - TOTP (Google Authenticator)
  - FIDO2/WebAuthn
  - 短信/邮件验证码

单点登录:
  - SAML 2.0
  - OAuth 2.0 / OIDC
  - Kerberos
```

### 授权模型
```yaml
RBAC (基于角色):
  用户 → 角色 → 权限
  示例:
    - admin: [read, write, delete]
    - editor: [read, write]
    - viewer: [read]

ABAC (基于属性):
  策略 = f(主体属性, 资源属性, 环境属性)
  示例:
    - 部门=财务 AND 级别>=3 → 访问财务报表

PBAC (基于策略):
  使用策略语言定义复杂规则
  示例: OPA/Rego
```

### JWT 最佳实践
```yaml
签名算法:
  - 使用 RS256 或 ES256
  - 避免 HS256 (共享密钥)
  - 禁止 none 算法

Token 管理:
  - 短期访问令牌 (15分钟)
  - 长期刷新令牌 (7天)
  - 令牌轮换
  - 黑名单机制

Claims:
  - iss: 签发者
  - sub: 主题
  - aud: 受众
  - exp: 过期时间
  - iat: 签发时间
  - jti: 唯一标识
```

## 威胁建模

### STRIDE 模型
```yaml
S - Spoofing (欺骗):
  威胁: 冒充用户身份
  缓解: 强认证、MFA

T - Tampering (篡改):
  威胁: 修改数据
  缓解: 完整性校验、签名

R - Repudiation (抵赖):
  威胁: 否认操作
  缓解: 审计日志、数字签名

I - Information Disclosure (信息泄露):
  威胁: 数据泄露
  缓解: 加密、访问控制

D - Denial of Service (拒绝服务):
  威胁: 服务不可用
  缓解: 限流、冗余

E - Elevation of Privilege (权限提升):
  威胁: 获取更高权限
  缓解: 最小权限、输入验证
```

### 威胁建模流程
```
1. 识别资产
   └─ 数据、服务、基础设施

2. 绘制数据流图
   └─ 信任边界、数据流向

3. 识别威胁
   └─ 使用 STRIDE 分析

4. 评估风险
   └─ 可能性 × 影响

5. 制定缓解措施
   └─ 技术控制、流程控制

6. 验证和迭代
   └─ 渗透测试、代码审计
```

## 安全设计原则

```yaml
纵深防御:
  - 多层安全控制
  - 单点失效不致命

最小权限:
  - 仅授予必要权限
  - 定期审查权限

安全默认:
  - 默认拒绝
  - 显式允许

失败安全:
  - 失败时拒绝访问
  - 不泄露敏感信息

分离职责:
  - 关键操作需多人
  - 开发/运维分离
```

## 安全架构检查清单

```yaml
认证:
  - [ ] 实施 MFA
  - [ ] 密码策略
  - [ ] 会话管理
  - [ ] 账户锁定

授权:
  - [ ] 最小权限
  - [ ] RBAC/ABAC
  - [ ] API 授权

数据保护:
  - [ ] 传输加密 (TLS)
  - [ ] 存储加密
  - [ ] 密钥管理

日志审计:
  - [ ] 安全事件日志
  - [ ] 访问日志
  - [ ] 日志保护

网络:
  - [ ] 网络分段
  - [ ] 防火墙规则
  - [ ] WAF
```

---

**道训**：架构即阵法，约束即阵眼，演进即破阵。
